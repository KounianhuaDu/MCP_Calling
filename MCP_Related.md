# MCP Survey

## 现有主要基线模型和评估框架
| 类别 | 名称 | 提出方/来源 | 主要特点/评估重点 | 在 MCP-Bench 相关测试中的备注 |
|------|------|-------------|------------------|------------------------------|
| 闭源/商用模型 | Claude-Sonnet-4 | Anthropic | 元工具学习能力 | 在 LiveMCPBench 的 70 服务器/527 工具测试中成功率最高（78.95%） |
|  | Claude-Opus-4 | Anthropic |  | 在 LiveMCPBench 中与人类评估一致性较高 |
|  | GPT-5 | OpenAI |  | 在 MCP-Universe 财务分析任务中表现好，但长上下文和未知工具处理仍存挑战 |
|  | Gemini 2.5 Pro | Google |  | 参与了 MCP-Universe 的评估 |
|  | Grok-4 | xAI |  | 在 MCP-Universe 浏览器自动化任务中表现较佳 |
| 开源模型 | Qwen2.5-72B-Instruct | 阿里巴巴 |  | 在 LiveMCPBench 评估中与人类评估者一致性约 75% |
|  | DeepSeek-V3 | DeepSeek | 常被用作评估中的“评判模型” | 在 LiveMCPBench 评估中与人类评估者一致性达 81% |
|  | GLM-4.5 | 智谱 AI |  | 在 MCP-Universe 测试中被评为表现最佳的开源模型之一 |
| 评估框架 | MCPBench (原始) |  | Web 搜索、数据库搜索任务的准确率、延迟、token 消耗 | 评估了 Bing、Brave、DuckDuckGo 等 MCP 服务器 |
|  | LiveMCPBench | 中科院软件所 | 大规模工具导航（70 服务器/527 工具）、真实动态任务、AI 评判 | 包含 95 个真实生活任务 |
|  | MCP-Universe | Salesforce AI Research | 企业级任务（6 大领域）、真实 MCP 服务器交互、长上下文处理 | 评估模型在真实业务场景中的表现 |
|  | MCP-AttackBench (安全方向) | 浙江大学、港中文等团队 | MCP 安全防御基准、7 大威胁类型、70k+ 样本 | 用于训练和评测 MCP-Guard 等防御体系 |

- 表中所列的基线模型，既有像 **Claude-Sonnet-4**、**GPT-5** 这样的闭源商用模型，也有如 **Qwen2.5-72B-Instruct**、**DeepSeek-V3** 等强大的开源模型。它们在不同的基准测试中接受评估，例如在工具使用准确性、多步推理、长上下文理解以及应对未知工具等方面的能力。

- 评估框架本身，如 **LiveMCPBench** 和 **MCP-Universe**，也构成了重要的基线参考。它们定义了任务类型、评估标准和环境，后续研究常会以此为基础比较新模型或系统的性能。**MCP-AttackBench** 则专注于安全维度。


## 方法论和评估框架总结

| 类别 | 名称/概念 | 核心思想 | 解决的主要问题 | 适用场景/案例 |
|---|---|---|---|---|
| 方法论 | 声明式接口 (Declarative Interface) | 将**复杂的参数构建（如SQL）从LLM转移至服务端**，LLM只需用自然语言描述意图。 | 参数构建困难、LLM生成复杂查询准确性低。 | XiYan MCP Server、自然语言转数据库查询 |
| 方法论 | 显式 vs 隐式调用 | **显式调用**：开发者手动控制工具调用的每个环节（解析LLM请求、执行工具、整合结果），**控制力强**。<br>**隐式调用**：LLM自动完成工具选择、参数生成和结果整合，**开发更高效**。 | 平衡开发效率与控制力；处理非结构化或易出错输出；需要直接获取原始数据（Raw Data）。 | 固定服务场景（显式）、通用Chat应用（隐式） |
| 评估框架 | MCPBench | 在**相同LLM和Agent配置**下，**公平评估**不同MCP服务器在**准确率、延迟、Token消耗**的表现。 | MCP服务器的性能横向对比；基础性能基准测试。 | Web搜索（Bing, DuckDuckGo）、数据库查询（MySQL, PostgreSQL） |
| 评估框架 | LiveMCPBench | 评估智能体在**大规模工具集（70+服务器, 527+工具）** 中**导航、发现并组合工具**完成**真实动态任务**的能力。 | 智能体在庞大工具集中的检索、规划与组合能力；应对真实任务的动态性。 | 办公、金融、旅行等95个真实生活任务 |
| 评估框架 | MCP专用评估系统 (如LiveMCPEval) | 采用 “LLM作为评判者”(LLM as a Judge) 的**自动化评估**方式，根据**任务关键点**动态判断成功与否。 | 工具输出的高度异质性和不稳定性；解决方案的多样性；动态任务的评估难题。 | 替代人工评估，处理大规模、动态性任务评估 |

## MCP工具调用的核心挑战

- 参数构建困难：LLM常需生成复杂的结构化参数（如SQL查询、API请求参数），这对其推理和规划能力要求很高，容易出错。
- 返回结果的高度异质性：不同工具返回的数据格式、结构和信息密度差异巨大（可能是原始数据、HTML片段、结构化JSON等），要求LLM具备强大的**信息抽取、摘要和整合能力**。
- 工具的动态性和不确定性：真实世界的工具（尤其是网络API）返回结果可能随时间、输入或外部状态变化，这要求智能体具备**鲁棒性**和**适应性**。

## 方法论层面的创新方案

为了解决上述问题，社区在方法论上进行了诸多探索：

1. 声明式接口 (Declarative Interface)：如 XiYan MCP Server 允许LLM用自然语言表达查询意图，由服务器端的专用模型（如文本到SQL模型）负责将自然语言转换为精确的结构化查询（如SQL语句）。这**大幅降低了LLM的负担**，提高了复杂操作的准确性。
  
2. 工具调用模式的选择与优化：根据应用场景在**显式调用**（更可控，适合需直接处理原始数据或复用现有逻辑的场景）和**隐式调用**（更高效，适合通用对话且信任LLM自动化能力的场景）间做选择，或采用 “半自动回填式显式调用” 等折中方案。

## 针对性的评估方式演进

传统的准确率、延迟等指标已不足以全面衡量MCP工具调用的复杂性，新的评估方式更注重：

1. 大规模工具导航与组合能力：LiveMCPBench等框架关注智能体在**海量工具集合中快速定位、选择并有效组合多个工具**完成复杂任务的能力，这更贴近现实应用场景。
2. 动态环境与真实任务下的鲁棒性：评估智能体处理**随时间变化的信息**、**应对工具输出不稳定**以及通过**多轮交互**完成长期规划任务的能力。
3. 基于关键点与LLM即评判员的自动化评估：LiveMCPEval系统通过定义任务完成的**关键点**，并采用经过验证的LLM（如DeepSeek-V3）作为自动评判员，以适应解决方案的多样性并提高评估效率，其与人类判断的一致性可达81%。

## 实践建议

面对这些方法论和评估框架，在实际应用中你可以考虑：

- 明确了解决策点：在选择方法前，想清楚是更看重**开发的效率和简易性**，还是对过程的**精确控制和数据的直接获取**。
- 从“模拟”走向“真实”：在项目后期，尽量在**真实工具环境**或像LiveMCPBench这样的**大规模真实工具集测试框架**中进行评估，这能更好地预测模型在实际中的表现。
- 评估需全面且有针对性：评估时不仅要看**最终任务是否成功**，还应关注**中间过程的可靠性**（如工具参数是否正确、调用序列是否合理）、**效率**（如耗时、Token消耗）以及应对**异常和变化**的能力。

## MCP分类和config格式总结

MCP（Model Context Protocol）为大型语言模型（LLM）提供了标准化的外部工具集成能力，使其能按需执行计算、操作外部系统，甚至与真实世界交互。下面为你总结各类 MCP 的注册方式和配置文件格式。

| 注册方式 | 适用场景 | 核心特点 | 协议类型选项 | 配置复杂度 |
|---|---|---|---|---|
| 标准 MCP 服务 | 从零开始构建完整的 MCP 服务。 | 提供完整控制权和灵活性，支持所有 MCP 特性。 | <ul><li>Stdio：本地进程通信，适合开发调试和离线环境。</li><li>SSE：单向实时通信，低延迟，兼容性强。</li><li>Streamable HTTP：双向通信，适合正式环境和跨网络部署。</li></ul> | 高 |
| HTTP 转化 MCP 服务 | 将现有的传统 HTTP 服务快速转换为 MCP 服务，复用现有资源。 | 转换和适配现有服务，平滑集成。 | SSE 或 Streamable HTTP | 中 |
| 动态注册 MCP 服务 | 服务实例需要动态注册和发现，或者希望实现工具描述和参数的热更新而无需重启服务。 | 通过 Nacos SDK 等服务注册中心实现自动注册和发现，支持服务元信息的热更新。 | 取决于服务本身的具体实现和与注册中心的交互方式。 | 中高 |

- MCP协议类型

MCP 服务在注册和配置时，需要根据实际场景选择合适的通信协议类型：
| 协议类型 | 通信方式 | 优点 | 缺点 | 适用场景 |
|----------|----------|------|------|----------|
| Stdio | 标准输入输出（命令行） | 简单直接，无需网络 | 无网络通信能力 | 本地开发调试、离线环境验证 |
| SSE | Server-Sent Events (单向流) | 低延迟、兼容性强 | 仅支持服务端到客户端的单向通信 | API 网关配置推送等单向实时通信场景 |
| Streamable HTTP | HTTP (支持双向流) | 支持双向通信，适合跨网络部署 | 相较于 SSE 更复杂 | 正式环境部署、混合云/跨 VPC 通信 |
| HTTP | 同步请求/响应 | 兼容性强，通用 | 不支持流式通信 | 大多数标准接口场景 |
| Webflux | 异步非阻塞（响应式） | 支持高并发和实时数据流，高性能 | 理解和实现相对复杂 | 需要快速响应和高并发的场景 |
| Spring Bean | 在 Spring 容器内调用 | 与 Spring 生态无缝集成 | 通常限于 Java Spring 应用 | 基于 Spring Bean 实现的 MCP 工具 |

- MCP配置文件
MCP配置文件普遍采用JSON格式，用于定义如何连接和启动MCP服务器。一个典型的MCP配置文件包含以下主要字段：

| 字段名 | 是否必需 | 描述 |
|--------|----------|------|
| `mcpServers` | 是 | 包含所有 MCP 服务器定义的对象。 |
| `server_name`（自定义） | —— | 服务的自定义标识符（如 `filesystem`、`fetch`）。 |
| `type` | 是 | 服务类型，例如 `stdio`（本地进程通信）或 `sse`（远程 Server-Sent Events API）。 |
| `command` | 是 | 启动服务器的命令（例如 `python script.py`）。 |
| `args` | 否 | 传递给命令的参数列表。 |
| `env` | 否 | 环境变量键值对，用于传递 API 密钥、路径配置等。 |
| `url` | 否 | 当类型为 `sse` 时，指定远程服务器的 URL。 |

- 配置示例
不同的部署方式，其配置文件也有所不同：
1. 使用NPX部署（常用于Node.js相关的MCP服务器）
```python
{
  "mcpServers": {
    "amap-maps": {
      "command": "npx",
      "args": [
        "-y",
        "@amap/amap-maps-mcp-server"
      ],
      "env": {
        "AMAP_MAPS_API_KEY": "你的API密钥"
      }
    }
  }
}
```

2. 使用 UVX 部署（使用 uvx 工具安装和运行）
```python
{
  "mcpServers": {
    "MCP-timeserver": {
      "command": "uvx",
      "args": ["MCP-timeserver"]
    }
  }
}
```

3. Remote URL (SSE) 方式（连接远程 SSE 服务）
```python
{
  "mcpServers": {
    "amap-maps-sse": {
      "url": "https://mcp.amap.com/sse?key=你的高德APIKey"
    }
  }
}
```

4. Spring Bean 方式（适用于 Spring 生态）
```python
spring:
  ai:
    mcp:
      server:
        name: my-spring-mcp-server
        type: SYNC
  alibaba:
    mcp:
      nacos:
        server-addr: your-nacos-server-addr
        namespace: public
```

**配置与验证注意事项**
- 环境准备：许多本地（Stdio）MCP 服务器需要预先安装必要的运行时环境，如 **Node.js**（用于 npx）、**Python** 或 **UV**（用于 uvx）。
- 依赖安装：确保 MCP 服务器所需的依赖包已正确安装。npx -y 和 uvx 通常会自动处理，但网络问题可能导致失败。
- 权限管理：访问本地文件系统或系统资源的服务器可能需要相应的权限。
- 测试验证：
  - 配置完成后，在客户端中检查 MCP 服务器状态（通常有绿灯或状态指示）。
  - 尝试在对话中触发相关工具，观察是否能正常调用并返回结果。

## 总结
MCP 通过标准化协议极大扩展了 LLM 的能力边界。你可以根据自身需求选择不同的注册方式，并理解不同协议类型的适用场景。关键点在于正确编写对应的 JSON 配置文件。

对于初学者，建议从**标准 MCP 服务**和 **Stdio 协议**开始试验；对于已有 HTTP 服务，可考虑通过 **HTTP 转化 MCP 服务**方式集成；而在微服务架构中，**动态注册**能提供更大的灵活性。
